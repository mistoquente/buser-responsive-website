 (
 	function(){

 		angular.module('app').
		directive('myMap', function() {
	    // directive link function
	    var link = function(scope, element, attrs) {
	        var map, infoWindow;
	        var markers = [];
	        
	        // map config
	        var mapOptions = {
	            center: {lat: -23.5489, lng: -46.6388},
	            zoom: 13,
	            mapTypeId: google.maps.MapTypeId.ROADMAP,
	            scrollwheel: false
	        };


	        
	        // init the map
	        function initMap() {
	            if (map === void 0) {
	                map = new google.maps.Map(element[0], mapOptions);
	            }
	            var busLines = [
                { lat: -23.630456, lng: -46.773630 },
                { lat: -23.630481, lng: -46.773582 },
                { lat: -23.630606, lng: -46.773343 },
                { lat: -23.630809, lng: -46.772954 },
                { lat: -23.630842, lng: -46.772894 },
                { lat: -23.630988, lng: -46.772630 },
                { lat: -23.631020, lng: -46.772564 },
                { lat: -23.631122, lng: -46.772357 },
                { lat: -23.631153, lng: -46.772293 },
                { lat: -23.631197, lng: -46.772204 },
                { lat: -23.631227, lng: -46.772143 },
                { lat: -23.631280, lng: -46.772040 },
                { lat: -23.631309, lng: -46.771984 },
                { lat: -23.631431, lng: -46.771748 },
                { lat: -23.631562, lng: -46.771509 },
                { lat: -23.630774, lng: -46.770773 },
                { lat: -23.629873, lng: -46.769945 },
                { lat: -23.629424, lng: -46.769467 },
                { lat: -23.629391, lng: -46.769417 },
                { lat: -23.629355, lng: -46.769351 },
                { lat: -23.629180, lng: -46.769073 },
                { lat: -23.628999, lng: -46.768733 },
                { lat: -23.628811, lng: -46.768391 },
                { lat: -23.628581, lng: -46.768017 },
                { lat: -23.628273, lng: -46.767620 },
                { lat: -23.628139, lng: -46.767485 },
                { lat: -23.628066, lng: -46.767406 },
                { lat: -23.627892, lng: -46.767269 },
                { lat: -23.627009, lng: -46.766561 },
                { lat: -23.626597, lng: -46.766221 },
                { lat: -23.626162, lng: -46.765836 },
                { lat: -23.625683, lng: -46.765447 },
                { lat: -23.625339, lng: -46.765123 },
                { lat: -23.625000, lng: -46.764866 },
                { lat: -23.624619, lng: -46.764599 },
                { lat: -23.624084, lng: -46.764344 },
                { lat: -23.623820, lng: -46.764170 },
                { lat: -23.623628, lng: -46.764032 },
                { lat: -23.623470, lng: -46.763901 },
                { lat: -23.623311, lng: -46.763731 },
                { lat: -23.623114, lng: -46.763489 },
                { lat: -23.622953, lng: -46.763248 },
                { lat: -23.622827, lng: -46.762999 },
                { lat: -23.622747, lng: -46.762805 },
                { lat: -23.622641, lng: -46.762499 },
                { lat: -23.622491, lng: -46.761938 },
                { lat: -23.622404, lng: -46.761445 },
                { lat: -23.622310, lng: -46.760964 },
                { lat: -23.622229, lng: -46.760495 },
                { lat: -23.622190, lng: -46.759938 },
                { lat: -23.622190, lng: -46.759501 },
                { lat: -23.622190, lng: -46.759342 },
                { lat: -23.622172, lng: -46.758848 },
                { lat: -23.622170, lng: -46.758731 },
                { lat: -23.622148, lng: -46.758585 },
                { lat: -23.622104, lng: -46.758478 },
                { lat: -23.622047, lng: -46.758364 },
                { lat: -23.621929, lng: -46.758200 },
                { lat: -23.621828, lng: -46.758086 },
                { lat: -23.621672, lng: -46.757937 },
                { lat: -23.621549, lng: -46.757819 },
                { lat: -23.621437, lng: -46.757747 },
                { lat: -23.621311, lng: -46.757699 },
                { lat: -23.621160, lng: -46.757639 },
                { lat: -23.621089, lng: -46.757618 },
                { lat: -23.621026, lng: -46.757604 },
                { lat: -23.620931, lng: -46.757598 },
                { lat: -23.620778, lng: -46.757605 },
                { lat: -23.620629, lng: -46.757654 },
                { lat: -23.619569, lng: -46.758060 },
                { lat: -23.618822, lng: -46.758300 },
                { lat: -23.618322, lng: -46.758487 },
                { lat: -23.618216, lng: -46.758485 },
                { lat: -23.618112, lng: -46.758479 },
                { lat: -23.618050, lng: -46.758461 },
                { lat: -23.617945, lng: -46.758393 },
                { lat: -23.617593, lng: -46.758015 },
                { lat: -23.617379, lng: -46.757728 },
                { lat: -23.617152, lng: -46.757513 },
                { lat: -23.616788, lng: -46.757262 },
                { lat: -23.616569, lng: -46.757142 },
                { lat: -23.615961, lng: -46.756849 },
                { lat: -23.615346, lng: -46.756391 },
                { lat: -23.615185, lng: -46.756251 },
                { lat: -23.615017, lng: -46.756094 },
                { lat: -23.614956, lng: -46.756017 },
                { lat: -23.614878, lng: -46.755929 },
                { lat: -23.614667, lng: -46.755780 },
                { lat: -23.614443, lng: -46.755659 },
                { lat: -23.614182, lng: -46.755550 },
                { lat: -23.614028, lng: -46.755444 },
                { lat: -23.613874, lng: -46.755399 },
                { lat: -23.613655, lng: -46.755330 },
                { lat: -23.613454, lng: -46.755259 },
                { lat: -23.613266, lng: -46.755171 },
                { lat: -23.613050, lng: -46.755034 },
                { lat: -23.612546, lng: -46.754680 },
                { lat: -23.612379, lng: -46.754579 },
                { lat: -23.611935, lng: -46.754358 },
                { lat: -23.611664, lng: -46.754261 },
                { lat: -23.611685, lng: -46.754137 },
                { lat: -23.611352, lng: -46.753542 },
                { lat: -23.610857, lng: -46.752818 },
                { lat: -23.610675, lng: -46.752557 },
                { lat: -23.610540, lng: -46.752420 },
                { lat: -23.610428, lng: -46.752321 },
                { lat: -23.610235, lng: -46.752234 },
                { lat: -23.610035, lng: -46.752227 },
                { lat: -23.609942, lng: -46.752200 },
                { lat: -23.609862, lng: -46.752159 },
                { lat: -23.609674, lng: -46.752032 },
                { lat: -23.609438, lng: -46.751853 },
                { lat: -23.609126, lng: -46.751710 },
                { lat: -23.608700, lng: -46.751569 },
                { lat: -23.608369, lng: -46.751465 },
                { lat: -23.608300, lng: -46.751445 },
                { lat: -23.608093, lng: -46.751390 },
                { lat: -23.607865, lng: -46.751311 },
                { lat: -23.607261, lng: -46.751112 },
                { lat: -23.606826, lng: -46.749653 },
                { lat: -23.606579, lng: -46.748839 },
                { lat: -23.606268, lng: -46.747832 },
                { lat: -23.606098, lng: -46.747400 },
                { lat: -23.605915, lng: -46.747154 },
                { lat: -23.605541, lng: -46.746533 },
                { lat: -23.605137, lng: -46.745994 },
                { lat: -23.604652, lng: -46.745480 },
                { lat: -23.604230, lng: -46.745152 },
                { lat: -23.603811, lng: -46.744845 },
                { lat: -23.603176, lng: -46.744470 },
                { lat: -23.603004, lng: -46.744349 },
                { lat: -23.602371, lng: -46.743996 },
                { lat: -23.602306, lng: -46.743928 },
                { lat: -23.602281, lng: -46.743903 },
                { lat: -23.601970, lng: -46.743621 },
                { lat: -23.601289, lng: -46.743000 },
                { lat: -23.600625, lng: -46.742419 },
                { lat: -23.599705, lng: -46.741733 },
                { lat: -23.598211, lng: -46.740735 },
                { lat: -23.597592, lng: -46.740361 },
                { lat: -23.597218, lng: -46.740101 },
                { lat: -23.596199, lng: -46.739392 },
                { lat: -23.595550, lng: -46.738941 },
                { lat: -23.595239, lng: -46.738695 },
                { lat: -23.594972, lng: -46.738123 },
                { lat: -23.594681, lng: -46.737478 },
                { lat: -23.594084, lng: -46.736119 },
                { lat: -23.593645, lng: -46.735112 },
                { lat: -23.593115, lng: -46.733865 },
                { lat: -23.592952, lng: -46.733484 },
                { lat: -23.592552, lng: -46.732522 },
                { lat: -23.592333, lng: -46.732035 },
                { lat: -23.592198, lng: -46.731762 },
                { lat: -23.592148, lng: -46.731700 },
                { lat: -23.591984, lng: -46.731545 },
                { lat: -23.591352, lng: -46.730920 },
                { lat: -23.590955, lng: -46.730551 },
                { lat: -23.590751, lng: -46.730349 },
                { lat: -23.589460, lng: -46.729179 },
                { lat: -23.589224, lng: -46.728900 },
                { lat: -23.588952, lng: -46.728465 },
                { lat: -23.588547, lng: -46.727794 },
                { lat: -23.588094, lng: -46.727072 },
                { lat: -23.587921, lng: -46.726823 },
                { lat: -23.587713, lng: -46.726535 },
                { lat: -23.587441, lng: -46.726122 },
                { lat: -23.587261, lng: -46.725847 },
                { lat: -23.587085, lng: -46.725465 },
                { lat: -23.586961, lng: -46.725157 },
                { lat: -23.586848, lng: -46.724850 },
                { lat: -23.586670, lng: -46.724392 },
                { lat: -23.586615, lng: -46.724242 },
                { lat: -23.586489, lng: -46.723910 },
                { lat: -23.586435, lng: -46.723765 },
                { lat: -23.586040, lng: -46.722670 },
                { lat: -23.585866, lng: -46.722189 },
                { lat: -23.585636, lng: -46.721619 },
                { lat: -23.585538, lng: -46.721402 },
                { lat: -23.585323, lng: -46.720829 },
                { lat: -23.585243, lng: -46.720576 },
                { lat: -23.585198, lng: -46.720414 },
                { lat: -23.585144, lng: -46.720236 },
                { lat: -23.585034, lng: -46.719838 },
                { lat: -23.584950, lng: -46.719400 },
                { lat: -23.584899, lng: -46.719082 },
                { lat: -23.584847, lng: -46.718641 },
                { lat: -23.584797, lng: -46.718264 },
                { lat: -23.584675, lng: -46.717905 },
                { lat: -23.584631, lng: -46.717771 },
                { lat: -23.584441, lng: -46.717441 },
                { lat: -23.584077, lng: -46.716946 },
                { lat: -23.583914, lng: -46.716536 },
                { lat: -23.583667, lng: -46.715849 },
                { lat: -23.583351, lng: -46.715068 },
                { lat: -23.583205, lng: -46.714746 },
                { lat: -23.583018, lng: -46.714263 },
                { lat: -23.582688, lng: -46.713503 },
                { lat: -23.582511, lng: -46.713131 },
                { lat: -23.582250, lng: -46.712622 },
                { lat: -23.581939, lng: -46.712234 },
                { lat: -23.581723, lng: -46.711979 },
                { lat: -23.581513, lng: -46.711783 },
                { lat: -23.580903, lng: -46.711378 },
                { lat: -23.580148, lng: -46.710938 },
                { lat: -23.579851, lng: -46.710749 },
                { lat: -23.579688, lng: -46.710646 },
                { lat: -23.579455, lng: -46.710424 },
                { lat: -23.579332, lng: -46.710253 },
                { lat: -23.578506, lng: -46.708869 },
                { lat: -23.578281, lng: -46.708588 },
                { lat: -23.578048, lng: -46.708337 },
                { lat: -23.577688, lng: -46.708065 },
                { lat: -23.577599, lng: -46.708017 },
                { lat: -23.577321, lng: -46.707887 },
                { lat: -23.576927, lng: -46.707721 },
                { lat: -23.576688, lng: -46.707601 },
                { lat: -23.575261, lng: -46.706937 },
                { lat: -23.574957, lng: -46.706819 },
                { lat: -23.574436, lng: -46.706528 },
                { lat: -23.573831, lng: -46.706243 },
                { lat: -23.573468, lng: -46.705927 },
                { lat: -23.573389, lng: -46.705827 },
                { lat: -23.573272, lng: -46.705646 },
                { lat: -23.573211, lng: -46.705497 },
                { lat: -23.573041, lng: -46.705116 },
                { lat: -23.572822, lng: -46.704748 },
                { lat: -23.572662, lng: -46.704407 },
                { lat: -23.572589, lng: -46.704278 },
                { lat: -23.572542, lng: -46.704002 },
                { lat: -23.572434, lng: -46.702915 },
                { lat: -23.572395, lng: -46.702449 },
                { lat: -23.572404, lng: -46.702308 },
                { lat: -23.572359, lng: -46.701570 },
                { lat: -23.572302, lng: -46.700998 },
                { lat: -23.572099, lng: -46.699330 },
                { lat: -23.572050, lng: -46.699146 },
                { lat: -23.571974, lng: -46.698799 },
                { lat: -23.571839, lng: -46.697479 },
                { lat: -23.571639, lng: -46.695762 },
                { lat: -23.571516, lng: -46.694845 },
                { lat: -23.571330, lng: -46.693547 },
                { lat: -23.571248, lng: -46.692494 },
                { lat: -23.571216, lng: -46.691588 },
                { lat: -23.571196, lng: -46.691255 },
                { lat: -23.571176, lng: -46.691040 },
                { lat: -23.571134, lng: -46.690779 },
                { lat: -23.571069, lng: -46.690552 },
                { lat: -23.570907, lng: -46.690270 },
                { lat: -23.570513, lng: -46.689547 },
                { lat: -23.569758, lng: -46.688132 },
                { lat: -23.569386, lng: -46.687451 },
                { lat: -23.568780, lng: -46.686283 },
                { lat: -23.568412, lng: -46.685619 },
                { lat: -23.568244, lng: -46.685285 },
                { lat: -23.567818, lng: -46.684506 },
                { lat: -23.567400, lng: -46.683745 },
                { lat: -23.567030, lng: -46.683041 },
                { lat: -23.565664, lng: -46.680422 },
                { lat: -23.565237, lng: -46.679608 },
                { lat: -23.564704, lng: -46.678664 },
                { lat: -23.564516, lng: -46.678306 },
                { lat: -23.564371, lng: -46.677975 },
                { lat: -23.564251, lng: -46.677744 },
                { lat: -23.563944, lng: -46.677168 },
                { lat: -23.563706, lng: -46.676673 },
                { lat: -23.563052, lng: -46.675772 },
                { lat: -23.562417, lng: -46.674962 },
                { lat: -23.562363, lng: -46.674867 },
                { lat: -23.561839, lng: -46.674003 },
                { lat: -23.561740, lng: -46.673825 },
                { lat: -23.561728, lng: -46.673612 },
                { lat: -23.561135, lng: -46.672918 },
                { lat: -23.560495, lng: -46.671828 },
                { lat: -23.559747, lng: -46.670482 },
                { lat: -23.558996, lng: -46.669108 },
                { lat: -23.558167, lng: -46.667672 },
                { lat: -23.558034, lng: -46.667446 },
                { lat: -23.557668, lng: -46.666885 },
                { lat: -23.557495, lng: -46.666633 },
                { lat: -23.557204, lng: -46.666170 },
                { lat: -23.557066, lng: -46.665910 },
                { lat: -23.556817, lng: -46.665475 },
                { lat: -23.556777, lng: -46.665377 },
                { lat: -23.556700, lng: -46.665080 },
                { lat: -23.556612, lng: -46.664693 },
                { lat: -23.556533, lng: -46.664416 },
                { lat: -23.556436, lng: -46.664002 },
                { lat: -23.556414, lng: -46.663921 },
                { lat: -23.556277, lng: -46.663646 },
                { lat: -23.555992, lng: -46.663163 },
                { lat: -23.555762, lng: -46.662873 },
                { lat: -23.555667, lng: -46.662755 },
                { lat: -23.555649, lng: -46.662733 },
                { lat: -23.555077, lng: -46.662040 },
                { lat: -23.553993, lng: -46.660729 },
                { lat: -23.553382, lng: -46.659909 },
                { lat: -23.552802, lng: -46.659082 },
                { lat: -23.551630, lng: -46.656981 },
                { lat: -23.549869, lng: -46.653686 },
                { lat: -23.549086, lng: -46.652322 },
                { lat: -23.548783, lng: -46.651631 },
                { lat: -23.548465, lng: -46.650517 },
                { lat: -23.548002, lng: -46.648959 },
                { lat: -23.547623, lng: -46.647813 },
                { lat: -23.547591, lng: -46.647716 },
                { lat: -23.547496, lng: -46.647459 },
                { lat: -23.547435, lng: -46.647242 },
                { lat: -23.547353, lng: -46.646987 },
                { lat: -23.547292, lng: -46.646717 },
                { lat: -23.547274, lng: -46.646600 },
                { lat: -23.547276, lng: -46.646312 },
                { lat: -23.547280, lng: -46.646180 },
                { lat: -23.547338, lng: -46.645870 },
                { lat: -23.547291, lng: -46.645205 },
                { lat: -23.547781, lng: -46.643020 },
                { lat: -23.547882, lng: -46.642620 },
                { lat: -23.547926, lng: -46.642476 },
                { lat: -23.547859, lng: -46.642084 },
                { lat: -23.547832, lng: -46.641935 },
                { lat: -23.547802, lng: -46.641764 },
                { lat: -23.547782, lng: -46.641653 },
                { lat: -23.547758, lng: -46.641519 },
                { lat: -23.547732, lng: -46.641377 },
                { lat: -23.547679, lng: -46.641092 },
                { lat: -23.547642, lng: -46.640891 },
                { lat: -23.547610, lng: -46.640715 },
                { lat: -23.547490, lng: -46.640068 },
                { lat: -23.547469, lng: -46.639953 },
                { lat: -23.547432, lng: -46.639754 }

          	];

          	var busLinePoints = new google.maps.Polyline({
              path: busLines,
              geodesic: true,
              strokeColor: '#FF0000',
              strokeOpacity: 2.0,
              strokeWeight: 4
          });

          	var image = 'https://raw.githubusercontent.com/mistoquente/buser-responsive-website/master/site/assets/images/icon-bus.png';
           var busMaker1 = new google.maps.Marker({
              position: {lng: -46.666633, lat: -23.557495},
              map: map,
              icon: image
          });
          var busMaker2 = new google.maps.Marker({
              position: {lat: -23.569758, lng: -46.688132},
              map: map,
              icon: image
          });
          var busMaker3 = new google.maps.Marker({
              position: {lat: -23.547642, lng: -46.640891},
              map: map,
              icon: image
          });

          busLinePoints.setMap(map);
          zoomToObject(busLinePoints);

          function zoomToObject(obj) {
              var bounds = new google.maps.LatLngBounds();
              var points = obj.getPath().getArray();
              for (var n = 0; n < points.length; n++) {
                  bounds.extend(points[n]);
              }
              map.fitBounds(bounds);
          }
	        }    
	        
	        // place a marker
	        function setMarker(map, position, title, content) {
	            var marker;
	            var markerOptions = {
	                position: position,
	                map: map,
	                title: title,
	                icon: 'https://maps.google.com/mapfiles/ms/icons/green-dot.png'
	            };

	            marker = new google.maps.Marker(markerOptions);
	            markers.push(marker); // add marker to array
	            
	            google.maps.event.addListener(marker, 'click', function () {
	                // close window if not undefined
	                if (infoWindow !== void 0) {
	                    infoWindow.close();
	                }
	                // create new window
	                var infoWindowOptions = {
	                    content: content
	                };
	                infoWindow = new google.maps.InfoWindow(infoWindowOptions);
	                infoWindow.open(map, marker);
	            });
	        }
	        
	        // show the map and place some markers
	        initMap();
	        
	        setMarker(map, new google.maps.LatLng(51.508515, -0.125487), 'London', 'Just some content');
	        setMarker(map, new google.maps.LatLng(52.370216, 4.895168), 'Amsterdam', 'More content');
	        setMarker(map, new google.maps.LatLng(48.856614, 2.352222), 'Paris', 'Text here');
	    };
	    
	    return {
	        restrict: 'A',
	        template: '<div id="gmaps"></div>',
	        replace: true,
	        link: link
	    };
	});



 })();